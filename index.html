<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <link rel="apple-touch-icon" href="https://i.ibb.co/27GqTXFn/Barber-Note.png">
    <title>Barber Note v12.5 Final Fixed</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;500;600&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #1e3a8a; --accent: #16a34a; --danger: #dc2626; --warning: #f59e0b;
            --main-bg: #f1f5f9; --card: #ffffff; --text: #1e293b; --input-bg: #f8fafc;
            --indigo: #818cf8; --border: #e2e8f0;
        }
        body.theme-dark { --main-bg: #0f172a; --card: #1e293b; --text: #f8fafc; --input-bg: #334155; --border: #475569; }
        body { margin: 0; font-family: 'Kanit', sans-serif; background: var(--main-bg); color: var(--text); padding-bottom: 90px; transition: 0.3s; font-weight: 300; overflow-x: hidden; }
        header { padding: 15px; background: var(--card); display: flex; align-items: center; border-bottom: 1px solid rgba(0,0,0,0.05); position: sticky; top:0; z-index:100; justify-content: space-between; }
        header h1 { font-size: 18px; margin: 0; font-weight: 500; }
        .container { max-width: 600px; margin: 0 auto; padding: 15px; }
        .page { display: none; animation: fadeIn 0.2s; }
        .page.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        .card { background: var(--card); border-radius: 20px; padding: 16px; margin-bottom: 12px; box-shadow: 0 4px 6px -1px rgba(0,0,0,0.05); }
        .grid-2 { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
        label { font-size: 13px; font-weight: 500; opacity: 0.8; margin-bottom: 5px; display: block; }
        input, select { width: 100%; padding: 12px; border-radius: 12px; border: none; font-size: 16px; box-sizing: border-box; background: var(--input-bg); color: var(--text); outline: none; font-family: 'Kanit'; }
        .btn-pay { border: 2px solid transparent; background: var(--input-bg); color: var(--text); padding: 12px; border-radius: 12px; font-weight: 500; cursor: pointer; transition: 0.2s; }
        .btn-pay.active-cash { border-color: var(--warning); color: var(--warning); background: #fffbeb; }
        .btn-pay.active-transfer { border-color: var(--primary); color: var(--primary); background: #eff6ff; }
        .status-bar { width: 100%; padding: 12px; border-radius: 15px; text-align: center; font-weight: 600; font-size: 15px; margin: 10px 0; box-sizing: border-box; }
        .status-red { background: #fee2e2; color: #dc2626; }
        .status-blue { background: #e0f2fe; color: #0284c7; }
        .status-indigo { background: #e0e7ff; color: #4338ca; }
        .nav { position: fixed; bottom: 0; left: 0; right: 0; background: var(--card); display: flex; border-top: 1px solid rgba(0,0,0,0.1); padding-bottom: env(safe-area-inset-bottom); z-index: 9999; height: 75px; align-items: center; }
        .nav-item { flex: 1; text-align: center; color: #94a3b8; font-size: 12px; cursor: pointer; display: flex; flex-direction: column; align-items: center; justify-content: center; gap: 4px; }
        .nav-item i { font-size: 20px; }
        .nav-item.active { color: var(--primary); font-weight: 600; }
        .btn-save { background: var(--primary); color: white; width: 100%; padding: 16px; border-radius: 16px; font-size: 18px; font-weight: 600; border: none; margin-top: 10px; cursor: pointer; }
        .modal { position: fixed; inset: 0; background: rgba(0,0,0,0.7); display: none; align-items: center; justify-content: center; z-index: 10000; padding: 20px; backdrop-filter: blur(5px); }
        .modal-content { background: var(--card); width: 100%; max-width: 450px; border-radius: 25px; padding: 25px; max-height: 90vh; overflow-y: auto; }
        .history-row { padding: 12px 0; border-bottom: 1px solid rgba(0,0,0,0.03); font-size: 14px; }
        .btn-clear { background: none; border: none; color: #f87171; font-size: 14px; width: 100%; margin-top: 25px; cursor: pointer; text-decoration: underline; }
    </style>
</head>
<body id="mainBody">

<header>
    <div style="width:40px"></div>
    <h1 id="shopNameDisp">Barber Note</h1>
    <div style="width:40px; text-align:right; cursor:pointer" onclick="openSettings()"><i class="fas fa-cog"></i></div>
</header>

<div class="container">
    <div id="p1" class="page active">
        <div class="card">
            <div style="display: flex; align-items: center; gap: 10px; margin-bottom:15px;">
                <i class="fas fa-calendar-day" style="color:var(--primary)"></i>
                <input type="date" id="dateInp" style="padding: 5px; background:none;">
            </div>
            <div class="grid-2">
                <div><label>‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°</label><input type="tel" id="tStart" placeholder="0900" maxlength="4"></div>
                <div><label>‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏™‡∏£‡πá‡∏à</label><input type="tel" id="tEnd" placeholder="0930" maxlength="4"></div>
            </div>
        </div>

        <div class="card">
            <label>‡∏ï‡∏±‡∏î‡∏ú‡∏° & ‡∏ó‡∏£‡∏á‡∏ú‡∏°</label>
            <div class="grid-2" style="margin-bottom:10px">
                <select id="mainSvc">
                     <option value="">(‡πÑ‡∏°‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å)</option>
                    <option value="‡πÄ‡∏î‡πá‡∏Å">‡πÄ‡∏î‡πá‡∏Å</option>
                 
                </select>
                <select id="hairStyle">
                    <option value="">(‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ó‡∏£‡∏á‡∏ú‡∏°)</option>
                    <option>‡∏£‡∏≠‡∏á‡∏ó‡∏£‡∏á</option><option>‡πÅ‡∏ü‡∏ä‡∏±‡πà‡∏ô</option><option>‡∏™‡∏Å‡∏¥‡∏ô‡πÄ‡∏ü‡∏î</option><option>‡∏ß‡∏¥‡∏ô‡πÄ‡∏ó‡∏à</option> <option>‡πÄ‡∏õ‡∏¥‡∏î‡∏Ç‡πâ‡∏≤‡∏á</option><option>‡∏ï‡∏≥‡∏£‡∏ß‡∏à/‡∏ó‡∏´‡∏≤‡∏£</option>
                 <option>‡∏ó‡∏£‡∏á‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</option>
                </select>
            </div>
            <div class="grid-2">
               <select id="extra1"><option value="">(‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏≠‡∏∑‡πà‡∏ô)</option><option>‡πÇ‡∏Å‡∏ô‡∏´‡∏ô‡∏ß‡∏î</option><option>‡∏Å‡∏±‡∏ô‡∏´‡∏ô‡πâ‡∏≤</option><option>‡∏™‡∏£‡∏∞‡∏ú‡∏°</option><option>‡∏¢‡πâ‡∏≠‡∏°‡∏ú‡∏°</option><option>‡∏î‡∏±‡∏î‡∏ú‡∏°</option><option>‡πÅ‡∏Å‡πâ‡∏ú‡∏°</option><option>‡πÇ‡∏Å‡∏ô‡∏ú‡∏°</<option></select>
                <select id="extra2"><option value="">(‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏≠‡∏∑‡πà‡∏ô2)</option><option>‡πÇ‡∏Å‡∏ô‡∏´‡∏ô‡∏ß‡∏î</option><option>‡∏Å‡∏±‡∏ô‡∏´‡∏ô‡πâ‡∏≤</option><option>‡∏™‡∏£‡∏∞‡∏ú‡∏°</option><option>‡∏¢‡πâ‡∏≠‡∏°‡∏ú‡∏°</option><option>‡∏î‡∏±‡∏î‡∏ú‡∏°</option><option>‡πÅ‡∏Å‡πâ‡∏ú‡∏°</option><option>‡πÇ‡∏Å‡∏ô‡∏ú‡∏°</<option></select>
            </div>
        </div>

        <div class="card">
            <label>‡∏Ñ‡πà‡∏≤‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£</label>
            <input type="number" id="priceInp" placeholder="0" inputmode="numeric" style="font-size:40px; font-weight:600; color:var(--primary); text-align:center; height:80px;">
            <div class="grid-2" style="margin-top:15px">
                <button id="btnCash" class="btn-pay" onclick="selectPay('Cash')">üíµ ‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î</button>
                <button id="btnTrans" class="btn-pay" onclick="selectPay('Trans')">üì± ‡πÇ‡∏≠‡∏ô‡πÄ‡∏á‡∏¥‡∏ô</button>
            </div>
        </div>
        <button class="btn-save" id="mainSaveBtn" onclick="handleSave()">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>
    </div>

    <div id="p2" class="page">
        <div class="grid-2">
            <div class="card" style="text-align: center;">
                <label>‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ</label>
                <div id="dTotal" style="font-size:28px; font-weight:600">0</div>
                <div id="dCounts" style="font-size:12px; opacity:0.6;">0 ‡∏Ñ‡∏ô</div>
            </div>
            <div class="card">
                <div style="font-size:13px; margin-bottom:4px;">üì± ‡πÇ‡∏≠‡∏ô: <b id="dTrans">0</b></div>
                <div style="font-size:13px; margin-bottom:4px;">ü§µ ‡∏ä‡πà‡∏≤‡∏á: <b id="dBarber">0</b></div>
                <div style="font-size:13px;">üè† ‡∏£‡πâ‡∏≤‡∏ô: <b id="dShop">0</b></div>
            </div>
        </div>
        <div id="settleBar" class="status-bar status-blue">‡∏¢‡∏≠‡∏î‡∏û‡∏≠‡∏î‡∏µ</div>
        <div class="card">
            <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:12px;">
                <label>‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ</label>
                <i class="fab fa-line" style="color:#06C755; font-size:24px; cursor:pointer;" onclick="shareLine()"></i>
            </div>
            <div id="dailyList"></div>
        </div>
    </div>

    <div id="p3" class="page">
        <div class="card">
            <label>‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏î‡∏π‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥</label>
            <input type="date" id="histDate" onchange="loadHistDaily()">
            <div id="histDailyArea" style="margin-top:15px"></div>
        </div>
    </div>
</div>

<div id="modalSet" class="modal">
    <div class="modal-content">
        <h3 style="margin-top:0">‚öôÔ∏è ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏£‡∏∞‡∏ö‡∏ö</h3>
        <label>‡∏ä‡∏∑‡πà‡∏≠‡∏£‡πâ‡∏≤‡∏ô</label><input id="setShop">
        <div class="grid-2" style="margin: 15px 0;">
            <div><label>% ‡∏ä‡πà‡∏≤‡∏á</label><input type="number" id="setPerc"></div>
            <div><label>‡∏õ‡∏£‡∏∞‡∏Å‡∏±‡∏ô‡∏£‡∏≤‡∏¢‡∏ß‡∏±‡∏ô</label><input type="number" id="setGuar"></div>
        </div>
        <button class="btn-save" onclick="saveSettings()">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>
        <button class="btn-pay" style="width:100%; margin-top:10px;" onclick="closeSettings()">‡∏õ‡∏¥‡∏î</button>
        <button class="btn-clear" onclick="clearAllData()">‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</button>
    </div>
</div>

<nav class="nav">
    <div class="nav-item active" id="n1" onclick="go(1)"><i class="fas fa-edit"></i>‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</div>
    <div class="nav-item" id="n2" onclick="go(2)"><i class="fas fa-calendar-check"></i>‡∏£‡∏≤‡∏¢‡∏ß‡∏±‡∏ô</div>
    <div class="nav-item" id="n3" onclick="go(3)"><i class="fas fa-history"></i>‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥</div>
</nav>

<script>
    let payMethod = "";
    let conf = JSON.parse(localStorage.getItem("barber_conf")) || {shop:"Barber Note", perc:50, guar:0};
    let db = JSON.parse(localStorage.getItem("barber_db")) || []; 

    window.onload = () => {
        document.getElementById("dateInp").valueAsDate = new Date();
        applySettings();
    };

    function go(n) {
        document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
        document.querySelectorAll('.nav-item').forEach(i => i.classList.remove('active'));
        document.getElementById('p'+n).classList.add('active');
        document.getElementById('n'+n).classList.add('active');
        if(n===2) renderDay();
    }

    function selectPay(m) {
        payMethod = m;
        document.getElementById("btnCash").className = m==='Cash'?'btn-pay active-cash':'btn-pay';
        document.getElementById("btnTrans").className = m==='Trans'?'btn-pay active-transfer':'btn-pay';
    }

    function handleSave() {
        const p = document.getElementById("priceInp").value;
        const main = document.getElementById("mainSvc").value;
        if(!p || !payMethod) return alert("‡∏£‡∏∞‡∏ö‡∏∏‡∏£‡∏≤‡∏Ñ‡∏≤‡πÅ‡∏•‡∏∞‡∏ß‡∏¥‡∏ò‡∏µ‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô");
        
        const svcs = [main];
        if(document.getElementById("extra1").value) svcs.push(document.getElementById("extra1").value);
        if(document.getElementById("extra2").value) svcs.push(document.getElementById("extra2").value);

        const rec = {
            id: Date.now(),
            date: document.getElementById("dateInp").value,
            time: `${document.getElementById("tStart").value}-${document.getElementById("tEnd").value}`,
            mainSvc: main,
            svcs: svcs,
            hair: document.getElementById("hairStyle").value,
            price: Number(p),
            pay: payMethod
        };
        db.push(rec);
        localStorage.setItem("barber_db", JSON.stringify(db));
        alert("‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à");
        document.getElementById("priceInp").value = "";
    }

    function renderDay() {
        const d = document.getElementById("dateInp").value;
        const today = db.filter(r => r.date === d);
        let tot = 0, trans = 0, cash = 0;
        let listHtml = "";

        today.forEach(r => {
            tot += r.price;
            if(r.pay === 'Trans') trans += r.price; else cash += r.price;
            listHtml += `<div class="history-row">${r.time} | ${r.svcs.join('+')} - ‡∏ø${r.price} (${r.pay === 'Cash' ? '‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î' : '‡πÇ‡∏≠‡∏ô'})</div>`;
        });

        const bEarn = Math.max(tot * (conf.perc / 100), conf.guar);
        const sEarn = tot - bEarn;
        const settle = cash - bEarn;

        document.getElementById("dTotal").innerText = tot.toLocaleString();
        document.getElementById("dTrans").innerText = trans.toLocaleString();
        document.getElementById("dBarber").innerText = bEarn.toLocaleString();
        document.getElementById("dShop").innerText = sEarn.toLocaleString();
        document.getElementById("dCounts").innerText = `${today.length} ‡∏Ñ‡∏ô`;
        document.getElementById("dailyList").innerHTML = listHtml || "<center style='padding:20px; opacity:0.3'>‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</center>";

        const bar = document.getElementById("settleBar");
        if (tot === 0 && conf.guar > 0) {
            bar.innerText = `üü¶ ‡∏õ‡∏£‡∏∞‡∏Å‡∏±‡∏ô‡∏°‡∏∑‡∏≠ ‡∏ø${Math.abs(settle).toLocaleString()}`;
            bar.className = "status-bar status-indigo";
        } else if (settle > 0) {
            bar.innerText = `üü• ‡∏ä‡πà‡∏≤‡∏á‡∏Ñ‡∏∑‡∏ô‡∏£‡πâ‡∏≤‡∏ô ‡∏ø${settle.toLocaleString()}`;
            bar.className = "status-bar status-red";
        } else if (settle < 0) {
            bar.innerText = `üü¶ ‡∏£‡πâ‡∏≤‡∏ô‡∏Ñ‡∏∑‡∏ô‡∏ä‡πà‡∏≤‡∏á ‡∏ø${Math.abs(settle).toLocaleString()}`;
            bar.className = "status-bar status-indigo";
        } else {
            bar.innerText = "‚úÖ ‡∏¢‡∏≠‡∏î‡∏•‡∏á‡∏ï‡∏±‡∏ß‡∏û‡∏≠‡∏î‡∏µ";
            bar.className = "status-bar status-blue";
        }
    }

    function shareLine() {
        const d = document.getElementById("dateInp").value;
        const today = db.filter(r => r.date === d);
        if (!today.length) return alert("‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•");

        let tot = 0, cash = 0, trans = 0;
        let shave = 0, wash = 0, dye = 0, kid = 0;

        today.sort((a, b) => a.time.localeCompare(b.time));

        today.forEach(r => {
            tot += r.price;
            if (r.pay === 'Cash') cash += r.price; else trans += r.price;
            if (r.mainSvc === "‡πÄ‡∏î‡πá‡∏Å") kid++;
            r.svcs.forEach(s => {
                if (s === "‡πÇ‡∏Å‡∏ô‡∏´‡∏ô‡∏ß‡∏î") shave++;
                if (s === "‡∏™‡∏£‡∏∞‡∏ú‡∏°") wash++;
                if (s === "‡∏¢‡πâ‡∏≠‡∏°‡∏ú‡∏°") dye++;
            });
        });

        const bEarn = Math.max(tot * (conf.perc / 100), conf.guar);
        const sEarn = tot - bEarn;
        const settle = cash - bEarn;
        const ds = d.split('-');
        const thaiDate = `${ds[2]}/${ds[1]}/${parseInt(ds[0]) + 543}`;

        let msg = `üíà ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏£‡πâ‡∏≤‡∏ô: ${conf.shop}\nüìÖ ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà: ${thaiDate}\n--------------------------\n`;
        msg += `üìù ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤ (‡∏£‡∏ß‡∏° ${today.length} ‡∏Ñ‡∏ô):\n`;

        today.forEach((r, i) => {
            const kidLabel = r.mainSvc === "‡πÄ‡∏î‡πá‡∏Å" ? "(‡πÄ‡∏î‡πá‡∏Å)" : ""; 
            const services = r.svcs.filter(s => s !== r.mainSvc).join('+');
            const style = r.hair ? r.hair : "";
            let detail = style;
            if (style && services) detail += "+" + services;
            else if (!style && services) detail = services;
            if (!detail) detail = "‡∏ï‡∏±‡∏î‡∏ú‡∏°";
            msg += `${i + 1}. [${r.time}] ${detail}${kidLabel} = ${r.price} ${r.pay === 'Cash' ? 'üíµ' : 'üì±'}\n`;
        });

        msg += `--------------------------\nüìä ‡∏™‡∏£‡∏∏‡∏õ‡∏á‡∏≤‡∏ô:\n`;
        if(kid > 0) msg += `üßí ‡πÄ‡∏î‡πá‡∏Å: ${kid} ‡∏Ñ‡∏ô\n`;
        if(shave > 0) msg += `ü™í ‡πÇ‡∏Å‡∏ô‡∏´‡∏ô‡∏ß‡∏î: ${shave} ‡∏Ñ‡∏ô\n`;
        if(wash > 0) msg += `üöø ‡∏™‡∏£‡∏∞‡∏ú‡∏°: ${wash} ‡∏Ñ‡∏£‡∏±‡πâ‡∏á\n`;
        if(dye > 0) msg += `üé® ‡∏¢‡πâ‡∏≠‡∏°‡∏ú‡∏°: ${dye} ‡∏Ñ‡∏£‡∏±‡πâ‡∏á\n`;
        msg += `--------------------------\n`;
        msg += `üí∞ ‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°: ${tot.toLocaleString()} ‡∏ö‡∏≤‡∏ó\n`;
        msg += `üì± ‡∏¢‡∏≠‡∏î‡πÇ‡∏≠‡∏ô: ${trans.toLocaleString()} ‡∏ö‡∏≤‡∏ó\n`;
        msg += `ü§µ ‡∏ä‡πà‡∏≤‡∏á: ${Math.floor(bEarn).toLocaleString()} ‡∏ö‡∏≤‡∏ó\n`;
        msg += `üè† ‡∏£‡πâ‡∏≤‡∏ô: ${Math.floor(sEarn).toLocaleString()} ‡∏ö‡∏≤‡∏ó\n`;
        msg += `--------------------------\n`;

        let setMsg = (tot === 0 && conf.guar > 0) ? `‡∏£‡πâ‡∏≤‡∏ô‡∏Ñ‡πâ‡∏≤‡∏á‡∏à‡πà‡∏≤‡∏¢‡∏ä‡πà‡∏≤‡∏á ${Math.abs(settle).toLocaleString()} ‡∏ö‡∏≤‡∏ó` : settle > 0 ? `‡∏ä‡πà‡∏≤‡∏á‡∏Ñ‡∏∑‡∏ô‡πÄ‡∏á‡∏¥‡∏ô‡πÉ‡∏´‡πâ‡∏£‡πâ‡∏≤‡∏ô ${Math.floor(settle).toLocaleString()} ‡∏ö‡∏≤‡∏ó` : settle < 0 ? `‡∏£‡πâ‡∏≤‡∏ô‡∏Ñ‡∏∑‡∏ô‡πÄ‡∏á‡∏¥‡∏ô‡πÉ‡∏´‡πâ‡∏ä‡πà‡∏≤‡∏á ${Math.floor(Math.abs(settle)).toLocaleString()} ‡∏ö‡∏≤‡∏ó` : "‡∏¢‡∏≠‡∏î‡∏•‡∏á‡∏ï‡∏±‡∏ß‡∏û‡∏≠‡∏î‡∏µ";
        msg += `‚ö†Ô∏è ${setMsg}`;

        window.open(`https://line.me/R/msg/text/?${encodeURIComponent(msg)}`);
    }

    function openSettings() { 
        document.getElementById("modalSet").style.display = "flex"; 
        document.getElementById("setShop").value = conf.shop;
        document.getElementById("setPerc").value = conf.perc;
        document.getElementById("setGuar").value = conf.guar;
    }
    function closeSettings() { document.getElementById("modalSet").style.display = "none"; }
    function saveSettings() {
        conf.shop = document.getElementById("setShop").value;
        conf.perc = Number(document.getElementById("setPerc").value);
        conf.guar = Number(document.getElementById("setGuar").value);
        localStorage.setItem("barber_conf", JSON.stringify(conf));
        applySettings(); closeSettings();
    }
    function applySettings() { document.getElementById("shopNameDisp").innerText = conf.shop; }
    function clearAllData() { if(confirm("‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î?")) { localStorage.clear(); location.reload(); } }
</script>
</body>
</html>
