<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Barber Note v5.5</title>
    <meta property="og:image" content="https://i.ibb.co/27GqTXFn/logo.jpg">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;500;600&display=swap" rel="stylesheet">
    <style>
        :root { --p-pink: #ffe4e6; --p-green: #dcfce7; --p-blue: #e0f2fe; --p-yellow: #fef9c3; --p-purple: #f3e8ff; --p-orange: #ffedd5; --p-gray: #f1f5f9; --text: #1e293b; --primary: #1e3a8a; }
        body { margin: 0; font-family: 'Kanit', sans-serif; background: var(--p-gray); color: var(--text); padding-bottom: 90px; }
        header { padding: 15px; background: #fff; display: flex; align-items: center; border-bottom: 1px solid #ddd; position: sticky; top:0; z-index:100; }
        header h1 { flex: 1; text-align: center; font-size: 18px; margin: 0; }
        .page { display: none; padding: 15px; }
        .page.active { display: block; }
        .card { background: #fff; border-radius: 20px; padding: 16px; margin-bottom: 12px; box-shadow: 0 2px 5px rgba(0,0,0,0.05); }
        .grid-2 { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
        label { font-size: 13px; font-weight: 600; margin-bottom: 5px; display: block; color: #64748b; }
        input, select { width: 100%; padding: 12px; border-radius: 12px; border: 1px solid #eee; font-size: 16px; background: #f8fafc; font-family: 'Kanit'; box-sizing: border-box; }
        
        /* Dashboard Layout */
        .db-container { display: flex; gap: 10px; }
        .db-side { flex: 1; padding: 12px; border-radius: 15px; background: #f1f5f9; border-top: 4px solid var(--primary); }

        /* Status Bars */
        .settle-bar { padding: 15px; border-radius: 15px; text-align: center; font-weight: 600; margin: 10px 0; }
        .bar-red { background: #fee2e2; color: #dc2626; border: 1px solid #fecaca; } 
        .bar-green { background: #dcfce7; color: #16a34a; border: 1px solid #bbf7d0; }
        .bar-blue { background: #e0f2fe; color: #0369a1; border: 1px solid #bae6fd; }

        .history-item { border-bottom: 1px solid #f1f5f9; padding: 12px 0; display: flex; justify-content: space-between; align-items: center; }
        .svc-time { font-size: 11px; color: #94a3b8; font-weight: bold; }

        .nav { position: fixed; bottom: 0; left: 0; right: 0; background: #fff; display: flex; height: 70px; border-top: 1px solid #eee; z-index:1000; }
        .nav-item { flex: 1; text-align: center; color: #94a3b8; font-size: 11px; padding-top: 12px; }
        .nav-item.active { color: var(--primary); }
        .nav-item i { font-size: 24px; display: block; margin-bottom: 4px; }

        .btn-action { width: 100%; padding: 18px; border-radius: 18px; font-size: 18px; font-weight: 600; border: none; color: white; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 10px; }
        .btn-pay { border: 2px solid transparent; padding: 15px; border-radius: 12px; font-weight: 600; cursor: pointer; }
        .btn-cash { background: #fff7ed; color: #f97316; border-color: #fdba74; }
        .btn-trans { background: #eff6ff; color: #3b82f6; border-color: #bfdbfe; }
        .line-btn { background: #06C755; color: #fff; border: none; border-radius: 50%; width: 45px; height: 45px; }
    </style>
</head>
<body>

<header>
    <div style="width:40px"></div>
    <h1 id="headerShopName">Barber Note</h1>
    <div style="width:40px; text-align:right;"><i class="fas fa-cog" onclick="go('settings')"></i></div>
</header>

<div id="p1" class="page active">
    <div class="card">
        <label>‡πÄ‡∏ß‡∏•‡∏≤ ‡πÄ‡∏£‡∏¥‡πà‡∏° - ‡πÄ‡∏™‡∏£‡πá‡∏à</label>
        <div class="grid-2">
            <input type="tel" id="tStart" placeholder="‡πÄ‡∏£‡∏¥‡πà‡∏°" maxlength="4" oninput="formatTime(this)">
            <input type="tel" id="tEnd" placeholder="‡πÄ‡∏™‡∏£‡πá‡∏à" maxlength="4" oninput="formatTime(this)">
        </div>
    </div>
    <div class="card">
        <label>‡πÅ‡∏ñ‡∏ß‡∏ó‡∏µ‡πà 1 (‡∏á‡∏≤‡∏ô‡∏ï‡∏±‡∏î‡∏ú‡∏°)</label>
        <div class="grid-2">
            <select id="isCut"><option value="‡∏ï‡∏±‡∏î‡∏ú‡∏°">‡∏ï‡∏±‡∏î‡∏ú‡∏°</option><option value="">‡∏õ‡∏•‡πà‡∏≠‡∏¢‡∏ß‡πà‡∏≤‡∏á</option></select>
            <select id="hairStyle"><option value="">(‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ó‡∏£‡∏á)</option><option>‡∏£‡∏≠‡∏á‡∏ó‡∏£‡∏á</option><option>‡∏™‡∏Å‡∏¥‡∏ô‡πÄ‡∏ü‡∏î</option><option>‡∏ß‡∏¥‡∏ô‡πÄ‡∏ó‡∏à</option><option>‡πÅ‡∏ü‡∏ä‡∏±‡πà‡∏ô</option><option>‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</option></select>
        </div>
        <label style="margin-top:10px;">‡πÅ‡∏ñ‡∏ß‡∏ó‡∏µ‡πà 2 (‡∏á‡∏≤‡∏ô‡πÄ‡∏™‡∏£‡∏¥‡∏°)</label>
        <div class="grid-2">
            <select id="extra1"><option value="">(‡πÄ‡∏™‡∏£‡∏¥‡∏° 1)</option><option>‡πÇ‡∏Å‡∏ô‡∏´‡∏ô‡∏ß‡∏î</option><option>‡∏Å‡∏±‡∏ô‡∏´‡∏ô‡πâ‡∏≤</option><option>‡∏™‡∏£‡∏∞‡∏ú‡∏°</option><option>‡∏¢‡πâ‡∏≠‡∏°‡∏ú‡∏°</option><option>‡∏î‡∏±‡∏î‡∏ú‡∏°</option><option>‡πÅ‡∏Å‡πâ‡∏ú‡∏°</option><option>‡πÇ‡∏Å‡∏ô‡∏ú‡∏°</option></select>
            <select id="extra2"><option value="">(‡πÄ‡∏™‡∏£‡∏¥‡∏° 2)</option><option>‡πÇ‡∏Å‡∏ô‡∏´‡∏ô‡∏ß‡∏î</option><option>‡∏Å‡∏±‡∏ô‡∏´‡∏ô‡πâ‡∏≤</option><option>‡∏™‡∏£‡∏∞‡∏ú‡∏°</option><option>‡∏¢‡πâ‡∏≠‡∏°‡∏ú‡∏°</option><option>‡∏î‡∏±‡∏î‡∏ú‡∏°</option></select>
        </div>
    </div>
    <div class="card">
        <label>‡∏£‡∏≤‡∏Ñ‡∏≤</label>
        <input type="number" id="priceInp" placeholder="0" style="font-size:40px; text-align:center; height:70px; font-weight:bold; width:100%;">
        <div class="grid-2" style="margin-top:15px">
            <button id="payCash" class="btn-pay btn-cash" onclick="setPay('Cash')">‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î (‡∏™‡πâ‡∏°)</button>
            <button id="payTrans" class="btn-pay btn-trans" onclick="setPay('Trans')">‡πÇ‡∏≠‡∏ô‡πÄ‡∏á‡∏¥‡∏ô (‡∏ü‡πâ‡∏≤)</button>
        </div>
    </div>
    <button class="btn-action" style="background:var(--primary);" onclick="handleSave()">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤</button>
    <label style="margin-top:20px;">‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ</label>
    <div id="listRecent" class="card"></div>
</div>

<div id="p2" class="page">
    <div class="card db-container">
        <div class="db-side">
            <label>‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏° (Total)</label>
            <div id="dTotal" style="font-size:24px; font-weight:bold;">0</div>
            <div id="dCount" style="font-size:11px;">‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤ 0 ‡∏Ñ‡∏ô</div>
        </div>
        <div class="db-side">
            <div style="font-size:12px;">‡πÇ‡∏≠‡∏ô: <b id="dTrans">0</b></div>
            <div style="font-size:12px;">‡∏ä‡πà‡∏≤‡∏á: <b id="dBarber">0</b></div>
            <div style="font-size:12px;">‡∏£‡πâ‡∏≤‡∏ô: <b id="dShop">0</b></div>
        </div>
    </div>
    <div id="settleBar" class="settle-bar"></div>
    <div class="card">
        <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:10px;">
            <label>‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ</label>
            <button class="line-btn" onclick="copyToLine()"><i class="fab fa-line"></i></button>
        </div>
        <div id="listToday"></div>
    </div>
    <button class="btn-action" style="background:var(--p-green); color:#16a34a;" onclick="confirmCloseDay()">‡∏õ‡∏¥‡∏î‡∏¢‡∏≠‡∏î‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ & ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥</button>
</div>

<div id="p3" class="page">
    <div class="card"><label>‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏î‡∏π‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥</label><input type="date" id="arcDate" onchange="loadArchive()"></div>
    <div id="arcResult" style="display:none;">
        <div id="arcSummaryCard" class="card"></div>
        <div id="arcSettleBar" class="settle-bar"></div>
        <div class="card">
            <label>‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏¢‡πâ‡∏≠‡∏ô‡∏´‡∏•‡∏±‡∏á‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î</label>
            <div id="arcList"></div>
            <hr>
            <label>‡∏ô‡∏±‡∏ö‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡πÅ‡∏¢‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó</label>
            <div id="arcCounter" style="display:grid; grid-template-columns:1fr 1fr; gap:5px; font-size:13px;"></div>
        </div>
    </div>
</div>

<div id="settings" class="page">
    <div class="card">
        <h3>‚öôÔ∏è ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤</h3>
        <label>‡∏ä‡∏∑‡πà‡∏≠‡∏£‡πâ‡∏≤‡∏ô</label><input type="text" id="setShop" oninput="updateSettings()">
        <div class="grid-2" style="margin-top:10px">
            <div><label>% ‡∏Ñ‡∏≠‡∏°‡∏°‡∏¥‡∏ä‡∏ä‡∏±‡πà‡∏ô</label><input type="number" id="setPerc" oninput="updateSettings()"></div>
            <div><label>‡∏õ‡∏£‡∏∞‡∏Å‡∏±‡∏ô‡∏£‡∏≤‡∏¢‡∏ß‡∏±‡∏ô</label><input type="number" id="setGuar" oninput="updateSettings()"></div>
        </div>
        <label style="margin-top:15px;">‡πÇ‡∏ó‡∏ô‡∏™‡∏µ‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á (7 ‡∏™‡∏µ)</label>
        <div class="grid-2" style="grid-template-columns: repeat(4, 1fr); gap:8px;">
            <button onclick="setTheme('--p-pink')" style="background:var(--p-pink); height:40px; border-radius:10px; border:1px solid #ddd;"></button>
            <button onclick="setTheme('--p-green')" style="background:var(--p-green); height:40px; border-radius:10px; border:1px solid #ddd;"></button>
            <button onclick="setTheme('--p-blue')" style="background:var(--p-blue); height:40px; border-radius:10px; border:1px solid #ddd;"></button>
            <button onclick="setTheme('--p-yellow')" style="background:var(--p-yellow); height:40px; border-radius:10px; border:1px solid #ddd;"></button>
            <button onclick="setTheme('--p-purple')" style="background:var(--p-purple); height:40px; border-radius:10px; border:1px solid #ddd;"></button>
            <button onclick="setTheme('--p-orange')" style="background:var(--p-orange); height:40px; border-radius:10px; border:1px solid #ddd;"></button>
            <button onclick="setTheme('--p-gray')" style="background:var(--p-gray); height:40px; border-radius:10px; border:1px solid #ddd;"></button>
        </div>
        <button class="btn-action" style="background:var(--danger); margin-top:30px;" onclick="fullReset()">‚ö†Ô∏è ‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</button>
        <button class="btn-action" style="background:#64748b; margin-top:10px;" onclick="go('p1')">‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å</button>
    </div>
</div>

<nav class="nav">
    <div class="nav-item active" id="n1" onclick="go('p1')"><i class="fas fa-edit"></i>‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</div>
    <div class="nav-item" id="n2" onclick="go('p2')"><i class="fas fa-file-invoice"></i>‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô</div>
    <div class="nav-item" id="n3" onclick="go('p3')"><i class="fas fa-history"></i>‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥</div>
</nav>

<script>
    let payType = "";
    let conf = JSON.parse(localStorage.getItem("bn55_conf")) || {shop:"Barber Note", perc:50, guar:0, theme:"--p-gray"};
    let db = JSON.parse(localStorage.getItem("bn55_db")) || [];
    let archive = JSON.parse(localStorage.getItem("bn55_arc")) || [];

    function formatTime(el) { let v = el.value.replace(/\D/g,''); if(v.length===4) el.value = v.substring(0,2)+":"+v.substring(2,4); }
    function setPay(m) { payType = m; document.getElementById("payCash").style.opacity = m==='Cash'?'1':'0.4'; document.getElementById("payTrans").style.opacity = m==='Trans'?'1':'0.4'; }
    function go(id) { document.querySelectorAll('.page').forEach(p=>p.classList.remove('active')); document.getElementById(id).classList.add('active'); document.querySelectorAll('.nav-item').forEach(i=>i.classList.remove('active')); if(id!=='settings') document.getElementById('n'+id.charAt(1)).classList.add('active'); renderAll(); }
    function haptic() { if(window.navigator.vibrate) window.navigator.vibrate(50); }

    function handleSave() {
        const p = document.getElementById("priceInp").value;
        if(!p || !payType) return alert("‡∏£‡∏∞‡∏ö‡∏∏‡∏£‡∏≤‡∏Ñ‡∏≤‡πÅ‡∏•‡∏∞‡∏ß‡∏¥‡∏ò‡∏µ‡∏à‡πà‡∏≤‡∏¢");
        let svcs = [];
        if(document.getElementById("isCut").value) svcs.push(document.getElementById("isCut").value + (document.getElementById("hairStyle").value ? "/" + document.getElementById("hairStyle").value : ""));
        if(document.getElementById("extra1").value) svcs.push(document.getElementById("extra1").value);
        if(document.getElementById("extra2").value) svcs.push(document.getElementById("extra2").value);

        db.push({ id:Date.now(), date:new Date().toLocaleDateString('th-TH'), time:`${document.getElementById("tStart").value||'00:00'}-${document.getElementById("tEnd").value||'00:00'}`, svcText:svcs.join(' + '), rawSvcs:svcs, price:Number(p), pay:payType });
        localStorage.setItem("bn55_db", JSON.stringify(db));
        haptic();
        document.getElementById("priceInp").value=""; document.getElementById("tStart").value=document.getElementById("tEnd").value; document.getElementById("tEnd").value=""; setPay(""); renderAll();
    }

    function renderAll() {
        const d = new Date().toLocaleDateString('th-TH'); const today = db.filter(r => r.date === d);
        let html = ""; let tot = 0, cash = 0, trans = 0;
        today.slice().reverse().forEach(r => {
            tot += r.price; if(r.pay==='Cash') cash+=r.price; else trans+=r.price;
            html += `<div class="history-item"><div><span class="svc-time">[${r.time}]</span><br>${r.svcText}</div><div><b>${r.price}</b> ${r.pay==='Cash'?'üíµ':'üì±'} <i class="fas fa-trash-alt" style="color:#ddd; margin-left:8px;" onclick="confirmDel(${r.id})"></i></div></div>`;
        });
        document.getElementById("listRecent").innerHTML = html || "‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£";
        document.getElementById("listToday").innerHTML = html;

        const bNet = Math.max(tot*(conf.perc/100), conf.guar); const settle = cash - bNet;
        document.getElementById("dTotal").innerText = tot.toLocaleString();
        document.getElementById("dCount").innerText = `‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤ ${today.length} ‡∏Ñ‡∏ô`;
        document.getElementById("dTrans").innerText = trans.toLocaleString();
        document.getElementById("dBarber").innerText = Math.floor(bNet).toLocaleString();
        document.getElementById("dShop").innerText = Math.floor(tot-bNet).toLocaleString();

        const sBar = document.getElementById("settleBar");
        if(tot===0) { sBar.className="settle-bar bar-blue"; sBar.innerText="‡∏£‡∏≠‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏á‡∏≤‡∏ô"; }
        else if(Math.abs(settle)<1) { sBar.className="settle-bar bar-blue"; sBar.innerText="‡∏¢‡∏≠‡∏î‡πÄ‡∏á‡∏¥‡∏ô‡∏•‡∏á‡∏ï‡∏±‡∏ß‡∏û‡∏≠‡∏î‡∏µ"; }
        else if(settle>0) { sBar.className="settle-bar bar-red"; sBar.innerText=`‡∏ä‡πà‡∏≤‡∏á‡∏Ñ‡∏∑‡∏ô‡∏£‡πâ‡∏≤‡∏ô ‡∏ø${Math.floor(settle)}`; }
        else { sBar.className="settle-bar bar-green"; sBar.innerText=`‡∏£‡πâ‡∏≤‡∏ô‡∏Ñ‡∏∑‡∏ô‡∏ä‡πà‡∏≤‡∏á ‡∏ø${Math.floor(Math.abs(settle))}`; }
    }

    function confirmDel(id) { if(confirm("‡∏•‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ô‡∏µ‡πâ?")) { db=db.filter(r=>r.id!==id); localStorage.setItem("bn55_db", JSON.stringify(db)); renderAll(); } }

    function copyToLine() {
        const d = new Date().toLocaleDateString('th-TH'); const today = db.filter(r=>r.date===d);
        if(!today.length) return;
        let msg = `‡∏™‡∏£‡∏∏‡∏õ‡∏á‡∏≤‡∏ô: ${conf.shop}\n‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà: ${d}\n------------------\n`;
        today.forEach((r,i)=> msg += `${i+1}. [${r.time}] ${r.svcText} = ${r.price}\n`);
        msg += `------------------\n‡∏£‡∏ß‡∏°: ${document.getElementById("dTotal").innerText}\n‡∏ä‡πà‡∏≤‡∏á: ${document.getElementById("dBarber").innerText}\n‡∏£‡πâ‡∏≤‡∏ô: ${document.getElementById("dShop").innerText}\n------------------\n` + document.getElementById("settleBar").innerText;
        navigator.clipboard.writeText(msg).then(()=>alert("‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏™‡∏£‡∏∏‡∏õ‡∏á‡∏≤‡∏ô‡πÄ‡∏Ç‡πâ‡∏≤ Line ‡πÅ‡∏•‡πâ‡∏ß!"));
    }

    function confirmCloseDay() {
        if(confirm("‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏õ‡∏¥‡∏î‡∏¢‡∏≠‡∏î? ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏∞‡∏ñ‡∏π‡∏Å Lock ‡πÅ‡∏•‡∏∞‡∏¢‡πâ‡∏≤‡∏¢‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥")) {
            const d = new Date().toLocaleDateString('th-TH'); const today = db.filter(r=>r.date===d);
            if(!today.length) return;
            archive.push({ date:d, data:today, shop:conf.shop });
            localStorage.setItem("bn55_arc", JSON.stringify(archive));
            db=db.filter(r=>r.date!==d); localStorage.setItem("bn55_db", JSON.stringify(db));
            go('p3');
        }
    }

    function loadArchive() {
        const target = new Date(document.getElementById("arcDate").value).toLocaleDateString('th-TH');
        const day = archive.find(a=>a.date===target);
        if(!day) { document.getElementById("arcResult").style.display="none"; return; }
        document.getElementById("arcResult").style.display="block";
        let tot=0, cash=0, counts={}; let html="";
        day.data.forEach(r => {
            tot += r.price; if(r.pay==='Cash') cash+=r.price;
            r.rawSvcs.forEach(s => { let k=s.split('/')[0]; counts[k]=(counts[k]||0)+1; });
            html += `<div class="history-item"><div>[${r.time}] ${r.svcText}</div><div>${r.price} ${r.pay==='Cash'?'üíµ':'üì±'}</div></div>`;
        });
        const bNet = Math.max(tot*(conf.perc/100), conf.guar); const settle = cash - bNet;
        document.getElementById("arcSummaryCard").innerText = `‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°: ${tot} | ‡∏ä‡πà‡∏≤‡∏á: ${Math.floor(bNet)} | ‡∏£‡πâ‡∏≤‡∏ô: ${Math.floor(tot-bNet)}`;
        const sBar = document.getElementById("arcSettleBar");
        sBar.className = settle>=0 ? "settle-bar bar-red" : "settle-bar bar-green";
        sBar.innerText = settle>=0 ? `‡∏ä‡πà‡∏≤‡∏á‡∏Ñ‡∏∑‡∏ô‡∏£‡πâ‡∏≤‡∏ô ‡∏ø${Math.floor(settle)}` : `‡∏£‡πâ‡∏≤‡∏ô‡∏Ñ‡∏∑‡∏ô‡∏ä‡πà‡∏≤‡∏á ‡∏ø${Math.floor(Math.abs(settle))}`;
        document.getElementById("arcList").innerHTML = html;
        let cHtml = ""; const icons={"‡∏ï‡∏±‡∏î‡∏ú‡∏°":"‚úÇÔ∏è","‡πÇ‡∏Å‡∏ô‡∏´‡∏ô‡∏ß‡∏î":"ü™í","‡∏Å‡∏±‡∏ô‡∏´‡∏ô‡πâ‡∏≤":"‚ú®","‡∏™‡∏£‡∏∞‡∏ú‡∏°":"üöø","‡∏¢‡πâ‡∏≠‡∏°‡∏ú‡∏°":"üé®","‡∏î‡∏±‡∏î‡∏ú‡∏°":"üåÄ","‡πÅ‡∏Å‡πâ‡∏ú‡∏°":"üõ†Ô∏è","‡πÇ‡∏Å‡∏ô‡∏ú‡∏°":"üßº"};
        Object.entries(counts).forEach(([k,v])=> cHtml += `<div>${icons[k]||'üîπ'} ${k}: ${v}</div>`);
        document.getElementById("arcCounter").innerHTML = cHtml;
    }

    function updateSettings() {
        conf.shop=document.getElementById("setShop").value;
        conf.perc=Number(document.getElementById("setPerc").value);
        conf.guar=Number(document.getElementById("setGuar").value);
        localStorage.setItem("bn55_conf", JSON.stringify(conf));
        document.getElementById("headerShopName").innerText=conf.shop;
    }

    function setTheme(v) { conf.theme=v; document.body.style.backgroundColor=`var(${v})`; localStorage.setItem("bn55_conf", JSON.stringify(conf)); }
    function fullReset() { if(confirm("‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î?")) { localStorage.clear(); location.reload(); } }

    document.getElementById("setShop").value=conf.shop; document.getElementById("setPerc").value=conf.perc;
    document.getElementById("setGuar").value=conf.guar; document.getElementById("headerShopName").innerText=conf.shop;
    document.body.style.backgroundColor=`var(${conf.theme})`; renderAll();
</script>
</body>
</html>
